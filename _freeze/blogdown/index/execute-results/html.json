{
  "hash": "a803855e513004131abc9a2654451b31",
  "result": {
    "markdown": "---\ntags: [\"R\", \"blog\"]\ntitle: \"From Hugo to R Blogdown\"\ndate: \"2020-04-18T15:00:20+10:00\"\nimage: \"/images/blogdown.png\"\n---\n\n\n[R blogdown](https://bookdown.org/yihui/blogdown/) gives a really easy way to post blogs containing evaluated R (and Python!) code chunks and plots.\nThis is really handy and can drop right into an existing Hugo blog with little modification.\nWhile there are some risks about the growing dependencies on building the blog, `blogdown` is well design to mitigate the issues and is very easy to set up.\n\n\nAbout 10 months ago I migrated my blog from [Hakyll](https://jaspervdj.be/hakyll/) to [Hugo](https://gohugo.io/) (after already migrating once from Wordpress).\nThere were three reasons, I wasn't using Haskell anymore, I wanted a prettier website through [Hugo themes](https://themes.gohugo.io/) and I wanted to use [R blogdown](https://bookdown.org/yihui/blogdown/) to write posts.\nI've finally migrated to using Blogdown (and am writing this post in it) and it was much easier than I thought.\n\nAfter reading a [tutorial of using blogdown with an existing Hugo site](https://itsalocke.com/blog/using-blogdown-with-an-existing-hugo-site/) I thought it sounded too easy.\nBut all I needed to do was install [the package](https://github.com/rstudio/blogdown) in R:\n\n```r\ninstall.packages(\"blogdown\")\n```\n\nAnd then I could immediately change building my website from `hugo` to:\n\n```\nR --vanilla --slave -e 'blogdown::build_site()'\n```\n\nI saw a really well written warning:\n\n>  Warning: You are recommended to ignore certain files in config.toml: set the option `ignoreFiles = [\"\\\\.Rmd$\", \"\\\\.Rmarkdown$\", \"_files$\", \"_cache$\"]`\n\nand simply adding that to the top of my `config.toml` fixed the warning.\n\nI could locally generate a preview on port 4321 with:\n\n```\nR --vanilla --slave -e 'blogdown::serve_site()'\n```\n\n# Benefits\n\nBlogdown makes it much easier for me to include the results of code snippets, including plots, in the post.\nWhile I could evaluate code manually, save the results and include it in my blogpost there are some advantages to having the generating code with the text.\nIt means I won't lose track of where the results came from, and someone else can even reproduce my results and enhance the code.\nI could even have dynamic posts that update with new data each time the site is built.\n\nAnother benefit is it uses the excellent [Pandoc](https://pandoc.org/) to convert to HTML which has lots of nice [features](https://pandoc.org/MANUAL.html#pandocs-markdown) and is familiar from my Hakyll days.\n\n## Examples\n\nUsing R markdown I can show R snippets with their results:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsqrt(2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.414214\n```\n:::\n:::\n\n\nEven better I can generate whole plots:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(cars, pch = 18)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nOr even embed [HTML Widgets](https://www.htmlwidgets.org/):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(leaflet)\n\nm <- leaflet() %>%\n  addTiles() %>%  # Add default OpenStreetMap map tiles\n  addMarkers(lng=174.768, lat=-36.852, popup=\"The birthplace of R\")\nm\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-4c1b310ca1e0b0d0def7\" style=\"width:100%;height:464px;\" class=\"leaflet html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-4c1b310ca1e0b0d0def7\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,null,{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org\\\">OpenStreetMap<\\/a> contributors, <a href=\\\"https://creativecommons.org/licenses/by-sa/2.0/\\\">CC-BY-SA<\\/a>\"}]},{\"method\":\"addMarkers\",\"args\":[-36.852,174.768,null,null,null,{\"interactive\":true,\"draggable\":false,\"keyboard\":true,\"title\":\"\",\"alt\":\"\",\"zIndexOffset\":0,\"opacity\":1,\"riseOnHover\":false,\"riseOffset\":250},\"The birthplace of R\",null,null,null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]}],\"limits\":{\"lat\":[-36.852,-36.852],\"lng\":[174.768,174.768]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nIn fact RMarkdown supports many difference [language engines](https://bookdown.org/yihui/rmarkdown/language-engines.html) including Python:\n\n\n::: {.cell}\n\n```{.python .cell-code}\nx = 'hello, python world!'\nprint(x.split(' '))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n['hello,', 'python', 'world!']\n```\n:::\n:::\n\n\nI can even include [Python plots](https://community.rstudio.com/t/how-to-display-the-plot-in-the-python-chunk/22039/2):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(reticulate)\nmatplotlib <- import(\"matplotlib\")\nmatplotlib$use(\"Agg\", force = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nimport pandas as pd\nimport matplotlib.pyplot as plt\ndf=pd.DataFrame([[1, 2], [3, 4], [4, 3], [2, 3]])\nfig = plt.figure(figsize=(14,8))\nfor i in df.columns:\n    ax=plt.subplot(2,1,i+1)\n    df[[i]].plot(ax=ax)\n    print(i)\n\nplt.show()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=1344}\n:::\n:::\n\n\n# Drawbacks\n\nRendering R markdown is slow and loading the served pages locally is really slow (probably because of the underlying [servr](https://github.com/yihui/servr) package).\nThis is really obvious after switching from Hugo because Go is basically built for serving things fast.\n\nAnother concern is environment management.\nThe simplest way to maintain a website is as a set of hand edited HTML files; this is likely to last for decades (like [John Baez's finds in mathematical physics](http://www.math.ucr.edu/home/baez/twfcontents.html)).\nUsing a static site generator has benefits, like being able to use markdown having an automatically generated index and links between pages, but means that you have to have the site generator available wherever you use it, and switching versions might break it.\nMoving to R Markdown makes the environment management more complicated; to get *this* page working requires at least R, the `blogdown` and `leaflet` packages, Python, `pandas` and `matplotlib`.\nRerunning on a different version of any package this might break the page; either silently (which I may not discover for a long time) or loudly (which may stop me from posting a new blog post).\n\nSome processes will also download data from the internet (which may disappear), or require a large amount of data (which either has to be committed or stored somewhere it can be downloaded) or take a long time to process.\nThis means that the process could break because of the dependencies, or be very expensive to rebuild each time.\n\nOne major ameliorating feature of blogdown is it produces the generated HTML files.\nThe blog can then be rendered directly via Hugo without having to have `R` and the dependencies installed.\nWhile in general I don't like committing generated files this kind of caching is pragmatic here.\n\n# Verdict\n\nR Markdown gives a convenient way to quickly generate calculations and plots in context with blog material.\nWhile there are some risks about being able to rerun this, it's handy enough for me that I'll use it.\nBecause blogdown generates an intermediate `.html` a broken environment shouldn't break the blog.\n\nI think I'm going to use a mixture of R Markdown, regular Markdown and Jupyter notebooks to my blog for now because they have different strengths.\nAs I work out a better workflow with R Markdown and solve environment management I may migrate to it more.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/htmlwidgets-1.5.4/htmlwidgets.js\"></script>\n<script src=\"../site_libs/jquery-1.12.4/jquery.min.js\"></script>\n<link href=\"../site_libs/leaflet-1.3.1/leaflet.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/leaflet-1.3.1/leaflet.js\"></script>\n<link href=\"../site_libs/leafletfix-1.0.0/leafletfix.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/proj4-2.6.2/proj4.min.js\"></script>\n<script src=\"../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js\"></script>\n<link href=\"../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/leaflet-binding-2.1.1/leaflet.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}