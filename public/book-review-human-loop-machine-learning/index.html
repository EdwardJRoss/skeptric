<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-07-30">

<title>skeptric - Human-in-the-Loop Machine Learning: Book review</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">skeptric</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">About</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/EdwardJRoss"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Human-in-the-Loop Machine Learning: Book review</h1>
  <div class="quarto-categories">
    <div class="quarto-category">books</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 30, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<blockquote class="blockquote">
<p>Most machine learning models are guided by human examples, but most machine learning texts and courses focus only on the algorithms. You can often get state-of-the-art results with good data and simple algorithms, but you rarely get state-of-the-art results with the best algorithm build on bad data.</p>
<p>Robert (Munro) Monarch, <em>Human-in-the Loop Machine Learning</em></p>
</blockquote>
<p><a href="https://www.manning.com/books/human-in-the-loop-machine-learning"><em>Human-in-the Loop Machine Learning</em></a> by Robert (Munro) Monarch is an excellent book on annotating data for Deep Learning practitioners in industry. It covers the whole process from selecting data with active learning, to quality control for teams of annotators, to the annotation interface. These are explained comprehensively focused on applying them in practice, and illustrated with common tasks such as text or image classification, image segmentation, object detection, named entity recognition, and translation.</p>
<p>I haven’t been able to find many good resources on the holistic process of annotating data for machine learning, and this stands out as a gem. Other books focus too much on the technical annotation model, representation, and tooling like <a href="https://www.oreilly.com/library/view/natural-language-annotation/9781449332693/">Natural Language Annotation for Machine Learning</a> and <a href="https://www.oreilly.com/library/view/training-data-for/9781492094517/">Training Data for Machine Learning</a> or dense academic tomes (like <a href="https://link.springer.com/book/10.1007/978-981-16-2960-0">Language Corpora Annotation and Processing</a> or the <a href="https://link.springer.com/book/10.1007/978-94-024-0881-2">Handbook of Linguistic Annotation</a>). In contrast <em>Human-in-the Loop Machine Learning</em> is a readable, focused work on efficiently getting humans to annotate data for real applications, full of useful insights from the authors real world experience. While at times it goes into great depth, for example in advanced active learning strategies, it’s mostly material that’s not well covered elsewhere, and the structure of the book makes it easy to only read what’s relevant. Given the multitude of resources available on machine learning it’s really surprising there aren’t more practical resources on data annotation.</p>
<p>The book consists of 5 parts; first steps, active learning, annotation, human-computer interface, and bringing it all together. The first steps has a detailed hands-on example of annotating news headlines referring to a disaster illustrating many of the concepts of the book, and which I’ve <a href="../disaster-annotation">previously written about</a>. Active learning explores ways of using models to effectively select data to annotate in a way that leads to better models with less human cost. Annotation goes in depth in how to work with annotation teams from how to work with people to annotate data through to quality control. Human Computer Interaction explores how to represent annotation tasks in a way that leads to fast, meaningful, and high quality annotation as well as exploring human-in-the loop use cases. The final chapter brings everything together with 3 case studies of different human-in-the-loop machine learning models, with their source code.</p>
<section id="active-learning" class="level1">
<h1>Active learning</h1>
<blockquote class="blockquote">
<p>You should use active learning when you can annotate only a small fraction of your data and when random sampling will not cover the diversity of the data.</p>
</blockquote>
<p>The active learning section discusses different ways to pick examples that are representative of a population, that the model is uncertain about, or that are diverse. The recommended method is interleaving all three methods; the representative samples form a conservative baseline, the uncertain items help improve the model by identifying borderline cases, and the diversity sampling finds items the model is unlikely to have seen. This also helps with human factors; uncertainty sampling and diversity sampling help pick interesting samples that keep the annotator engaged.</p>
<p>Representative sampling is the simplest method; most generally picking items completely at random from those available. This helps the model get slowly better, but in many cases its inefficient because a lot of similar items end up being annotated that don’t help the model. It’s always a safe fallback if the other methods fail. There is some choice in terms of the population, and it can be extended by stratifying across different factors such as time or demographics to make it representative across these factors.</p>
<p>Choosing the examples that the model is uncertain about is a good way of getting the most model improvement per annotation. It turns out there’s a lot of ways of doing this and subtlety in the method. In particular this book goes in depth into how the base (or equivalently temperature) of the softmax can change what ranks as “most uncertain”; this exemplifies what this book is great at - going into the details of things you won’t find elsewhere. It goes through increasingly sophisticated ways of active learning, such as using other models to predict the model uncertainty.</p>
<p>I hadn’t previously considered the importance of diversity sampling; finding the “unknown unknowns” of the model. However this is important in real world scenarios; we normally want the model to work in unusual cases. It’s not obvious how to find these; some methods suggested are using clustering, LDA, or samples where the last layer of the neural network has low activation. Each of these methods can find different kinds of outliers, but the text gives no clear way to evaluate them.</p>
</section>
<section id="annotation-and-accuracy" class="level1">
<h1>Annotation and accuracy</h1>
<blockquote class="blockquote">
<p>The more respect you show the people who label your data, the better your data becomes.</p>
</blockquote>
<p>The book has chapters on how to work with annotation teams, and how to evaluate their accuracy. I haven’t worked much in this area but the suggestions on annotation teams make a lot of sense, and seem to be drawn from the authors experience. Treat the people who label data well, make sure they understand their impact, work closely with them. There are good intuitive outlines of different commonly used statistics.</p>
<p>One concept I struggled with was the idea of “ground truth” and treating annotators as independent. How do you get “ground truth” examples for data labelled by humans, when even experts will make mistakes? Treating annotators as independent is statistically convenient for quality control, but might you get better results if you give feedback and let annotators collaborate? While these ideas are useful for modelling quality control, some careful thought needs to go into any particular usecase.</p>
<blockquote class="blockquote">
<p>A real-time chat allows annotators to collaborate on hard-to-annotate items, the only downside being that quality control becomes harder when annotators aren’t independent.</p>
</blockquote>
<p>Indeed what “ground truth” is depends a lot on the application. Designing an appropriate annotation model and guidelines is slippery business, and there are lots of edge cases. The book could have gone into more detail here about choosing and defining tasks appropriate to a business goal and dealing with ambiguity.</p>
<blockquote class="blockquote">
<p>we spent more time on refining the definiiton of what goes into a span than on any other part of the task</p>
</blockquote>
<p>There are some good references from the book that go into more of the difficulty of annotating data:</p>
<ul>
<li><a href="https://ojs.aaai.org//index.php/aimagazine/article/view/2564">Truth Is a Lie: Crowd Truth and the Seven Myths of Human Annotation</a></li>
<li><a href="https://arxiv.org/abs/1908.07898">Are We Modeling the Task or the Annotator? An Investigation of Annotator Bias in Natural Language Understanding Datasets</a></li>
<li><a href="https://www.microsoft.com/en-us/research/publication/revolt-collaborative-crowdsourcing-labeling-machine-learning-datasets/">Revolt: Collaborative Crowdsourcing for Labeling Machine Learning Datasets</a></li>
</ul>
</section>
<section id="interfaces" class="level1">
<h1>Interfaces</h1>
<p>The user interface can make a huge impact on efficiency, accuracy, and the agency in annotation. There are lots of good examples in the text about designing user interfaces, such as using predictive typing to speed up translation (which is much more efficient than correcting suggestions), or instead of highlighting sentiment words asking to edit the words to express the opposite sentiment (changing the task to a more informative one), or <a href="https://arxiv.org/abs/1708.02750">Extreme clicking for efficient object annotation</a> where instead of drawing a bounding box you click on each of the highest, lowest, left-most and right-most point (which is 6x more efficient, and captures more information).</p>
<p>There’s lots of general user experience tips in here too. Making sure the interface can capture all the information annotators feel are important (general features include being able to add notes, or flag examples). If end users are annotating an optional field, a suggestion is to pre-fill it because “people are more averse to wrong data than to missing data” and are more likely to correct it.</p>
<blockquote class="blockquote">
<p>The biggest shortcoming of training data provided by your users is that the users essentially drive your sampling strategy.</p>
</blockquote>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<blockquote class="blockquote">
<p>Understanding the human task that you are solving will help every aspect of your prdoct design: interface, annotations, and machine learning architecture</p>
</blockquote>
<p>The last chapter brings everything together in three fully coded Human-in-the Loop examples on <a href="https://github.com/rmunro/bicycle_detection">Bicycle Detection</a>, <a href="https://github.com/rmunro/food_safety">Food Safety</a> and <a href="https://github.com/rmunro/headlines">News Headlines</a>. I’ll go into more detail on them in following posts, but these are very interesting and exciting examples of how these techniques can be used.</p>
<p>These kinds of tools could completely change the face of analytics. Working as an analyst machine translation (e.g.&nbsp;<a href="../python-offline-translation">including via OpenNMT and Marian MT</a>) has greatly increased my ability to find information in documents in other languages. However this just scratches the surface; these kinds of tools can help extract concepts via example and quickly scale annotation. I’ve previously found analytics has focused on things easy to extract; things that match regular expressions (such as phone numbers or email), or keyword matching with stemming and splitting. Anything that requires custom development is too expensive for a lot of one-off analytics use cases, but these techniques could greatly reduce the cost.</p>
<p>They have already changed the face of digital products. Things like auto-completion, pre-filling fields, and scrolling feeds are increasingly powered by machine learning with tight feedback loops. They involve a tight coupling between a computer interface and a machine learning model, that helps people achieve a task and allows appropriate annotation (often implicitly or explicitly by the end user). Some good resources referenced in the book for these are Microsoft’s <a href="http://erichorvitz.com/Guidelines_Human_AI_Interaction.pdf">Guidelines for Human-AI Interaction</a> (see also their <a href="https://www.microsoft.com/en-us/haxtoolkit/">Human-AI eXperience (HAX) Toolkit</a>) and <a href="https://www.oreilly.com/library/view/building-machine-learning/9781492045106/">Building Machine Learning Powered Applications</a> by Emmanuel Ameisen.</p>
<p>This book fills a major gap in all the machine learning resources I can find, in a practical guide of how to efficiently collect accurate labelled data with worked examples of Human-in-the Loop processes. It focuses much more on annotation being a <em>human</em> task to help <em>human</em> ends than other machine learning books, which either take it as a given or focus on the technical process. It’s surprising there’s not more of this; when I studied Physics we learned about our measurement equipment, the basics of electronics, the kinds of systematic and random errors that occur, and did laboratory work of running experiments. I haven’t seen another machine learning book that talks about human factors in annotation, the basics of psychology, the kinds of systematic errors (such as priming) that occur, and actually labelled some data. The closest I’ve seen is in survey methodology, which tends to be focused more in marketing and user experience departments, and is different to many of the annotation tasks in machine learning. Hopefully as transfer learning and better tooling makes machine learning more accessible, there will be more resources like this book to ensure we get the most out of them.</p>
<blockquote class="blockquote">
<p>Rather than spending a month figuring out an unsupervised machine learning problem, just label some data for a week and train a classifier.</p>
<p><a href="https://twitter.com/richardsocher/status/840333380130553856?lang=en">Richard Socher</a></p>
</blockquote>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>