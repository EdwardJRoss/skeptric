<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2021-03-03">

<title>skeptric - Probability Distributions Between the Mean and the Median</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">skeptric</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">About</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/EdwardJRoss"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Probability Distributions Between the Mean and the Median</h1>
  <div class="quarto-categories">
    <div class="quarto-category">maths</div>
    <div class="quarto-category">data</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 3, 2021</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>The normal distribution is used throughout statistics, because of the <a href="https://en.wikipedia.org/wiki/Central_limit_theorem">Central Limit Theorem</a> it occurs in many applications, but also because it’s computationally convenient. The expectation value of the normal distribution is the mean, which has many nice arithmetic properties, but the drawback of being sensitive to outliers. When discussing <a href="../constant-models">constant models</a> I noted that the minimiser of the <a href="https://en.wikipedia.org/wiki/Lp_space#The_p-norm_in_finite_dimensions">Lᵖ error</a> is a generalisation of the mean; for <span class="math inline">\(p = 2\)</span> it’s the mean, for <span class="math inline">\(p = 1\)</span> it’s the median, and for <span class="math inline">\(p = \infty\)</span> it’s the midrange (half way betwen the maximum and minimum points). We can similarly generalise the normal distribution to a family of exponential distributions, <span class="math inline">\(\frac{A}{\sigma} e^{- \alpha \left\vert\frac{x - \mu}{\sigma}\right\vert^p}\)</span> where the expectation value <span class="math inline">\(\mu\)</span> is the minimiser of the Lᵖ error. This distribution can then be used for estimates less sensitive to outliers, for p between 1 and 2.</p>
<section id="calculating-the-moments" class="level2">
<h2 class="anchored" data-anchor-id="calculating-the-moments">Calculating the moments</h2>
<p>Consider the probability distributions of the form above:</p>
<p><span class="math display">\[f(x) = \frac{A}{\sigma} e^{- \alpha \left\vert\frac{x - \mu}{\sigma}\right\vert^p}\]</span></p>
<p>The constant A is determined by normalisation <span class="math inline">\(\int_{-\infty}^{\infty} f(x) = 1\)</span>. Using the <a href="../integrating-power-exponential">power exponential formulas</a> gives the normalising constant as <span class="math inline">\(A = \frac{p \alpha^{\frac{1}{p}}}{2 \Gamma\left(\frac{1}{p}\right)}\)</span>. Using normalisation and symmetry the mean is <span class="math inline">\(\int_{-\infty}^{\infty} x f(x) = \mu\)</span>. With a little more caluclation using the power exponential formulas it can be shown the variance is <span class="math inline">\(\int_{-\infty}^{\infty} x^2 f(x) = \sigma^2\)</span> if <span class="math inline">\(\alpha = \left(\frac{\Gamma\left(3/p\right)}{\Gamma\left(1/p\right)}\right)^{p/2}\)</span>. So for example in the case <span class="math inline">\(p = 2\)</span> we get the familiar constant of 1/2 in the normal distribution exponent.</p>
<p>Given data how do we estimate the mean <span class="math inline">\(\mu\)</span> and the standard deviation <span class="math inline">\(\sigma\)</span> for the distribution <span class="math inline">\(\frac{A}{\sigma} e^{- \alpha \left\vert\frac{x - \mu}{\sigma}\right\vert^p}\)</span>? With the data <span class="math inline">\(X_1, X_2, \ldots, X_n\)</span> the log-likelihood is:</p>
<p><span class="math display">\[l(\mu, \sigma) = N \log(A) - N \log(\sigma) - \alpha \sum_{i=1}^{N} \left\vert \frac{X_i - \mu}{\sigma} \right\vert ^ p\]</span></p>
<p>The Maxmium Likelihood Estimator for the expectation value of the distribution <span class="math inline">\(\mu\)</span> is the minimiser of <span class="math inline">\(\left\vert X_i - \mu \right\vert^ p\)</span>, which is precisely the minimiser of the Lᵖ error. So for <span class="math inline">\(p = 2\)</span> the expectation value is estimated by the mean, for <span class="math inline">\(p = 1\)</span> by the median and as <span class="math inline">\(p \rightarrow \infty\)</span> by the midrange. The Maximum Likelihood Estimator for <span class="math inline">\(\sigma\)</span> is</p>
<p><span class="math display">\[\hat{\sigma} = \left(\frac{p \alpha}{N} \sum_{i=1}^{N} \left\vert X_i - \mu \right\vert^p\right)^{1/p}\]</span></p>
<p>which is, up to a multiplicative constant, the Lᵖ error.</p>
<p>So by modelling data under the probability distribution <span class="math inline">\(\frac{A}{\sigma} e^{- \alpha \left\vert\frac{x - \mu}{\sigma}\right\vert^p}\)</span> the Maximum Likelihood Estimate for <span class="math inline">\(\mu\)</span> is the minimiser of Lᵖ error, and for <span class="math inline">\(\sigma\)</span> is the Lᵖ error up to a constant factor. This could be used as a model in a regression allowing different kinds of estimates; in particular for <span class="math inline">\(p = 1\)</span>, with distribution <span class="math inline">\(\sqrt{\frac{3}{2}} e^{-\sqrt{6}\left\vert\frac{x - \mu}{\sigma}\right\vert}\)</span> the MLE estimate is the median and the MAD is <span class="math inline">\(\frac{\hat{\sigma}}{\sqrt{6}}\)</span>. A reparameterisation of the exponent variable could ensure the MLE is the Lᵖ error, but then the variable would no longer correspond with the square root of the variance of the distribution.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>