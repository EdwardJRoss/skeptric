<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2020-05-12">

<title>skeptric - From Bernoulli to Binomial Distributions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">skeptric</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">About</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/EdwardJRoss"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">From Bernoulli to Binomial Distributions</h1>
  <div class="quarto-categories">
    <div class="quarto-category">data</div>
    <div class="quarto-category">maths</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 12, 2020</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>Suppose that you flip a fair coin 10 times, how many heads will you get? You’d think it was close to 5, but it might be a bit higher or lower. If you only got 7 heads would you reconsider you assumption the coin is fair? What if you got 70 heads out of 100 flips?</p>
<p>This might seem a bit abstract, but the inverse problem is often very important. Given that 7 out of 10 people convert on a new call to action, can we say it’s more successful than the existing one that converts at 50%? This could be people any proportion, from patients that recover from a medical treatment to people that act on a recommendation. To understand this inverse problem it helps to understand the problem above.</p>
<p>This situation where there are two possible outcomes that occur is called a <a href="https://en.wikipedia.org/wiki/Bernoulli_trial">Bernoulli Trial</a>. For mathematical convenience we label the outcomes 0 and 1 (for “failure” and “success”, but the assignment is arbitrary), and denote the probability of 1 by <em>p</em>. Because there are only two possible outcomes and the total probability is 1, the probability for the outcome 0 is <em>1-p</em>. Concretely if there’s 30% chance of someone opening an email you sent (p=0.3), then there’s a 70% chance they don’t open it.</p>
<p>Let’s label the outcome of the Bernoulli Trial by the random variable <em>Y</em>. Mathematically we would write the last paragraph as the pair of equations <span class="math inline">\(P(Y=1) = p\)</span> and <span class="math inline">\(P(Y=0) = 1-p\)</span>. There’s a mathematical trick to write these as a single equation: anything to the power of 1 is itself and anything to the power of 0 is 1 (except <a href="https://en.wikipedia.org/wiki/Zero_to_the_power_of_zero">sometimes 0</a>). So we can rewrite the equations as <span class="math inline">\(P(Y=1) = p^1(1-p)^0\)</span> and <span class="math inline">\(P(Y=0) = p^0(1-p)^1\)</span>. Then we can combine them as <span class="math inline">\(P(Y=y) = p^y(1-p)^{1-y}\)</span> for <em>y</em> either 0 or 1. This bit of arithmetic is a convenient trick.</p>
<p>Any variable <em>Y</em> that satisfies these equations is called <a href="https://en.wikipedia.org/wiki/Bernoulli_distribution">Bernoulli distributed</a>. The expectation value of <em>Y</em> is <span class="math inline">\(E(Y) = \sum_y P(Y=y) y\)</span>, which is <em>p</em>. Similarly the expectation value of <span class="math inline">\(Y^2\)</span> also <em>p</em>; since the square of 0 is 0 and the square of 1 is 1, it’s the same. So the variance of <em>Y</em> is <span class="math inline">\(V(Y) = E(Y^2) - E(Y)^2 = p - p^2 = p(1-p)\)</span>.</p>
<p>To interpret this the expectation value is the same as the probability of success, since we coded success as 1 and failure as 0. The variance is a quadratic intersecting the x-axis at 0 and 1. Notice that the variance is 0 if <em>p</em> is 0 or 1; we always get failure or always get success. The variance is maximum when <em>p</em> is 0.5; that’s when we get the biggest spread between heads and tails. When <em>p</em> is one half then the deviation from the mean is plus or minus one half, giving a variance of one quarter.</p>
<p>What if we run multiple independent trials? That is we send multiple emails to different people, or treat multiple different patients, or flip the coin multiple times. We ignore anything else we know and treat them as if they all have the same probability <em>p</em>, since the <a href="../bernoulli-mixing">mixture or Bernouli’s is Bernoulli</a>. How many successes will we get?</p>
<p>Denote each trial by <span class="math inline">\(Y_i\)</span>, and the total number of successes in N trials by <span class="math inline">\(Z = \sum_{i=1}^{N} Y_i\)</span>. Then the probability can be written as <span class="math inline">\(P(Z=k) = {N \choose k} p^k (1-p)^{N-k}\)</span>. This can be seen because the number of ways of getting <em>k</em> successes out of <em>N</em> trials is given by the <a href="https://en.wikipedia.org/wiki/Binomial_coefficient">binomial coefficient</a> <span class="math inline">\({N \choose k}\)</span>. Then given <em>k</em> successes and <em>N - k</em> failures the probability of that outcome is the product of the probability for each Bernoulli random variable; <span class="math inline">\(p^k (1-p)^{N-k}\)</span>. A variable with this probability distribution is called <a href="https://en.wikipedia.org/wiki/Binomial_distribution">Binomally distributed</a>.</p>
<p>Concretely flipping a fair coin 3 times, each time the result is H or T. There is only one way to get 3 heads, HHH, but 3 ways to get 2 heads and 1 tail; THH, HTH, HHT. Since each outcome is equally likely in this example <span class="math inline">\(P(Z=3) = \frac{1}{8}\)</span> and <span class="math inline">\(P(Z=2) = \frac{3}{8}\)</span>. You can visualise this with <a href="../probability-square">probability squares</a>.</p>
<p>This answers the question of how many heads you would expect if you flip a fair coin 10 times. The probability of getting exactly 5 heads is <span class="math inline">\({5 \choose 10} \frac{1}{2^{10}}\)</span> which is approximately 25%. But the probability of getting exactly 10 heads is <span class="math inline">\(\frac{1}{2^{10}}\)</span> which is about 0.1%. Doing these calculations is straightforward on a computer; but we can get a general idea by looking at the mean and standard deviation.</p>
<p>Trying to calculate the expectation value and variance directly from the probability distribution requires some tricky combinatorics, like you’d find in the excellent book <a href="https://en.wikipedia.org/wiki/Concrete_Mathematics">Concrete Mathematics</a>. But the expectation value of a sum of random variables is the sum of the expectation values; so <span class="math inline">\(E(Z) = \sum_{i=1}^{N} E(Y_i) = Np\)</span>. This makes intuitive sense; if we send out 100 emails and the open rate is 30%, we expect <span class="math inline">\(100 \times 0.3 = 30\)</span> emails to be opened.</p>
<p>Similarly the variance of a sum of <em>independent</em> random variables is the sum of their variances. So the total variance is <span class="math inline">\(V(Z) = Np(1-p)\)</span>, and so the standard deviation increases with the square root of N. The <a href="https://en.wikipedia.org/wiki/Coefficient_of_variation">coefficient of variation</a>, that is the standard deviation relative to the mean, is <span class="math inline">\(\sqrt{\frac{1-p}{Np}}\)</span>. So quadrupling the sample size halves the spread of the results relative to the mean.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/binomial_spread.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Spread halves as sample size quadruples</figcaption><p></p>
</figure>
</div>
<p>For example there’s a 96% chance of getting 40 to 60 heads in 100 flips of a fair coin; that is 50 ± 20%. If we quadruple the number of flips we just double the range; so there 96% change of getting 180 to 220 heads in 400 flips of a fair coin, that is 200 ± 10%. If we quadruple the number flips again then in 1600 flips there’s a 95% chance of getting 800 ± 5% heads, that is 760 to 840 heads.</p>
<p>In fact as the number of trials increases the binomial distribution gets close to a <a href="https://en.wikipedia.org/wiki/Normal_distribution">Normal distribution</a>. It’s a <a href="http://www-stat.wharton.upenn.edu/~tcai/paper/html/Binomial-StatSci.html">bit complicated</a> exactly when this approximation applies, but it’s slower for more extreme <em>p</em>.</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>