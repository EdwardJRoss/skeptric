<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2020-03-24">

<title>skeptric - Don’t manage work email with Emacs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">skeptric</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">About</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/EdwardJRoss"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Don’t manage work email with Emacs</h1>
  <div class="quarto-categories">
    <div class="quarto-category">emacs</div>
    <div class="quarto-category">linux</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 24, 2020</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>I do a lot of work in Emacs and at the command line, and I get quite a few emails so it would be great if I could handle my emails there too. Email in Emacs can be surprisingly featureful and handles HTML markup, images and can even send <a href="https://kitchingroup.cheme.cmu.edu/blog/2016/10/29/Sending-html-emails-from-org-mode-with-org-mime/">org markup with images and equations</a> all from the comfort of an Emacs buffer. However it can be a whole <em>heap</em> of work, and as you get deeper into the features your mail client provides the amount of custom integration required grows very rapidly. It’s a good way to appreciate all the features of your current mail client, but you may be able to find a better use of your time.</p>
<p>Getting the basics of synchronising emails from an IMAP or Exchange server may take some time to setting up (and in some circumstances take a <em>lot</em> of time), but once they’re working it will be pretty smooth. Dealing with HTML and images and attachments works pretty well out of the box, unless you get a lot of custom office drawings in your email. Building an address book of frequent contacts is a bit of a pain, but with some work is possible. Synchronising email addresses from the server can be difficult, and may need to be done in batches - but you might be able to manually. Getting calendar invites is possible with a bit of hacking, but seeing other people’s calendars is very difficult. Finally if the server configuration is changed (like changing an authentication provider) you may have to spend a lot of time setting it up all over again.</p>
<p>The benefits are that it tends to be faster to get through emails (because they are on the local filesystem), you don’t need to change environments to use them and you can use all your favourite CLI tools on them. But unless email is a very large part of your working life (and it seems to be slowly losing out to instant messaging clients) it’s probably not worth the investment (unless you want to build a custom email automation tool one day!).</p>
<p>I’ll share some of my experience doing this for those who are hard to discourage.</p>
<section id="operating-environment" class="level1">
<h1>Operating Environment</h1>
<p>If you want to set up email from the command line or Emacs you’ll want to be working in a POSIXy environment, because that’s where all the tooling is. If your working environment supports Linux or Mac computers then it’s happy times. However if you’re working in Windows you have a few options.</p>
<p>The best Windows option is <a href="https://docs.microsoft.com/en-us/windows/wsl/faq">Windows Subsystem for Linux</a> - it lets you run a whole Linux environment and works pretty well with Windows. There are a couple of creaky edges, mainly the filesystem is slow (which should be fixed in <a href="https://docs.microsoft.com/en-us/windows/wsl/wsl2-index">WSL2</a>), but overall it’s the best solution <strong>if</strong> you can get the <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">feature enabled</a>.</p>
<p>If you can’t then working in a <a href="https://www.virtualbox.org">Virtualbox VM</a> for Linux is the next best option; and you can configure it to be fairly seamless. However you can’t use it if there’s any other virtualisation on your machine like Docker for Windows. In fact some organisations use security software that uses virtualisation making it impossible to install Virtualbox. But if you can get Virtualbox running (or your organisation supports another virtualisation product) then it’s generally a good solution.</p>
<p>When all else fails there is good ol’ <a href="https://www.cygwin.com/">Cygwin</a>. It doesn’t require any special permissions, so as long as you can run external applications on your computer it should work. It’s a bit clunky, and you may need to build some utilities (like <code>isync</code>, see below) yourself, but with a bit of work you can get a usable environment. I’ve heard <a href="https://www.msys2.org/">msys2</a> is better but have never taken the time to understand it.</p>
</section>
<section id="synchronising-email" class="level1">
<h1>Synchronising email</h1>
<p>You now need a way to pull email to your local filesystem and push emails back out. For pushing emails <a href="www.postfix.org">Postfix</a> works great (and has a <code>sendmail</code> interface) and I’ve never needed anything else. For pulling emails you can run a email server like <a href="https://www.dovecot.org/">Dovecot</a>, but it’s quite a bit of effort to set up. The easiest solution is to use <a href="http://isync.sourceforge.net/">isync/mbsync</a>, or it’s slower cousin <a href="http://www.offlineimap.org/">offlineimap</a>.</p>
<p>Both <a href="http://isync.sourceforge.net/mbsync.html#CONFIGURATION">mbsync</a> and <a href="https://github.com/OfflineIMAP/offlineimap/blob/master/offlineimap.conf">offlineimap</a> have gnarly configuration options that will make you learn quite a bit about the low level details of email authentication and <a href="https://en.wikipedia.org/wiki/Maildir">Maildir</a>. And if you set the wrong options you might accidentally delete your whole email; so spend a lot of time reading through them and try it out on a test account before you run it on your precious emails. To get authentication details for your email provider the easiest thing to do is to search the web, and if you have a common email provider (like Gmail, Office365, Fastmail) you’ll likely find a blog with a sample configuration. If you’ve got an uncommon provider look in their documentation/settings for SMTP and IMAP; if the Auth method isn’t clear it’s best to try to set it up with <a href="https://www.thunderbird.net/en-US/">Thunderbird</a> first because it has some magic to automatically detect these settings and is more likely to work out of the box.</p>
<p>If your email provider doesn’t have IMAP enabled then you’re probably out of luck - unless it’s an exchange server. If you can’t get app passwords and need to use two factor authentication you may spend a <em>lot</em> of time trying to get this set up (and may have to implement the feature!).</p>
<p>If you’re on an Exchange server or on Office365 but can’t access IMAP then you can use the fantastic <a href="http://davmail.sourceforge.net/">Davmail</a>. Davmail also supports CalDAV and CardDAV for calendar and contacts (more on this later). The only issue is finding the Exchange server settings can take some sleuthing (or a beer with your local sysadmin). As before it’s best to get it working in Thunderbird before trying another synchronising tool, because it’s easiest to get working there.</p>
</section>
<section id="setting-up-a-mail-interface" class="level1">
<h1>Setting up a mail interface</h1>
<p>So now you’ve got all your emails sitting in a maildir folder it’d be handy to have a tool for reading and writing email.</p>
<p>If you’re a serious vim user <a href="http://www.mutt.org/">mutt</a> may be a good option. <a href="https://notmuchmail.org/">notmuch</a> has a powerful tag system, but you have to manually sync it yourself between servers (and the <a href="https://notmuchmail.org/notmuch-emacs/">Emacs mode</a> has too many special screens for my liking). In Emacs <a href="https://www.gnu.org/software/emacs/manual/html_node/gnus/Maildir.html">gnus</a> is built-in, but has a byzantine configuration system that you could spend the rest of your life tweaking (like this <a href="https://github.com/jwiegley/dot-emacs/blob/master/gnus-settings.el">John Wiegley’s</a>). But gnus is apparently good if you’re on a lot of mailing lists. However for me <a href="https://www.djcbsoftware.nl/code/mu/">mu</a> and it’s Emacs counterpart <a href="https://www.djcbsoftware.nl/code/mu/mu4e.html">mu4e</a> work fantastically well - you just have to take the time to learn yet another query language (and if you use evil-mode there are mu4e keybindings in <a href="https://github.com/emacs-evil/evil-collection/">evil-collection</a>).</p>
<p>This is generally pretty straightforward (especially if you can crib a configuration file that is close to what you need), but there are some traps like if you use mbsync and mu4e you need to set <code>mu4e-change-filenames-when-moving</code> to true or you’ll get all sorts of errors when trying to sync. You can then spend a bunch of time configuring <a href="https://www.reddit.com/r/emacs/comments/9ep5o1/mu4e_stop_emails_setting_backgroundforeground/">how HTML is rendered</a>, <a href="http://pragmaticemacs.com/emacs/master-your-inbox-with-mu4e-and-org-mode/">storing links to emails in org-mode</a> and <a href="https://kitchingroup.cheme.cmu.edu/blog/2016/10/29/Sending-html-emails-from-org-mode-with-org-mime/">sending email from org-mode</a>.</p>
</section>
<section id="dealing-with-contacts" class="level1">
<h1>Dealing with contacts</h1>
<p>Now you can write email you may want to store the addresses of people you want to contact. Many email providers support the <a href="https://en.wikipedia.org/wiki/CardDAV">CardDav</a> format and you can synchronise it locally with a tool like <a href="https://asynk.io/">ASynK</a> or <a href="https://github.com/pimutils/vdirsyncer">vdirsyncer</a>. You can then import them into org contacts with <a href="https://github.com/flexibeast/org-vcard">org-vcard</a> and <a href="https://www.djcbsoftware.nl/code/mu/mu4e/Maintaining-an-address_002dbook-with-org_002dcontacts.html">configure mu4e</a> to use them for auto-completion. Or use them with <a href="https://www.jwz.org/bbdb/">BBDB</a> for Emacs email clients that support them, or write a script to convert them to <a href="https://gitlab.com/muttmua/mutt/-/wikis/MuttGuide/Aliases">Mutt aliases</a>.</p>
<p>One problem is if you work for an enterprise with thousands of people that’s going to be a lot of email addresses, and the syncing or the interface may choke. You can probably get away with just manually copying the addresses of the people you email most often into the configuration of whatever tool you use. But once in a while you’ll want to email someone in your organisation and you may have to fall back to another tool to get the address book.</p>
</section>
<section id="calendars-and-meeting-invites" class="level1">
<h1>Calendars and meeting invites</h1>
<p>Calendars is something where Outlook groupware really shines. You can see everyone’s calendar and schedule a meeting in free time using the scheduling assistant (and book meeting rooms!). While this can lead to the problem of <a href="https://jack.ofspades.com/calendar-tetris-is-an-antipattern/">calendar tetris</a> where other people unilaterally fill the blanks in your Calendar, it’s generally a useful organisational feature and can sometimes even be used to list and book available meeting rooms.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/outlook_scheduling_assistant.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Outlook Scheduling Assistant</figcaption><p></p>
</figure>
</div>
<p>I haven’t found anything that quite substitutes for it in an office environment. You could manage your calendar with a command line tool in <a href="https://github.com/pimutils/khal">khal</a> or in Emacs with <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Calendar_002fDiary.html">diary/calendar</a> or <a href="https://orgmode.org/manual/Weekly_002fdaily-agenda.html">org-agenda</a> or <a href="https://github.com/kiwanami/emacs-calfw">calfw</a> and synchronise it over iCal. You can probably even get meeting invites into your calendar and respond to the invitation (<a href="https://github.com/djcb/mu/issues/994">mu4e supports this</a>). But I doubt there’s anything like the scheduling assistant and if you organise a lot of meetings in an Outlook office you’ll be falling back to Outlook a lot.</p>
<p>If you get this far you can spend a lot more time smoothing out the rough edges. It’s certainly possible to do, but worth thinking about whether it’s really going to pay off for the time investment. But maybe you can walk the path and enjoy the journey as much as I did.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>